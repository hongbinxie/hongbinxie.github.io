<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.lug.ustc.edu.cn/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="主要目的学习数据库怎么安装、怎么使用、怎么通过代码的方式去操作它。 什么是数据库数据库是一种数据存储的手段，只不过为了便于我们对数据的操作做了很多功能。 数据库就是数据的仓库，用来按照特定的结构去组织和管理我们的数据，有了数据库我们就可以更加方便、便捷的 操作（C &#x2F; R &#x2F; U &#x2F; D）我们需要保存的数据。 数据库查询：指的是操作数据库的过程（增、删、改、查） 数据库查询语言：SQL（结构化查询">
<meta property="og:type" content="article">
<meta property="og:title" content="04-MySQL">
<meta property="og:url" content="http://yoursite.com/2020/03/29/04-MySQL/index.html">
<meta property="og:site_name" content="凝水为城">
<meta property="og:description" content="主要目的学习数据库怎么安装、怎么使用、怎么通过代码的方式去操作它。 什么是数据库数据库是一种数据存储的手段，只不过为了便于我们对数据的操作做了很多功能。 数据库就是数据的仓库，用来按照特定的结构去组织和管理我们的数据，有了数据库我们就可以更加方便、便捷的 操作（C &#x2F; R &#x2F; U &#x2F; D）我们需要保存的数据。 数据库查询：指的是操作数据库的过程（增、删、改、查） 数据库查询语言：SQL（结构化查询">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/hongbinxie/pic-bad/master/img/%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="https://raw.githubusercontent.com/hongbinxie/pic-bad/master/img/%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B.png">
<meta property="article:published_time" content="2020-03-29T14:42:20.805Z">
<meta property="article:modified_time" content="2020-03-29T15:03:30.316Z">
<meta property="article:author" content="谢红斌">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/hongbinxie/pic-bad/master/img/%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B.png">

<link rel="canonical" href="http://yoursite.com/2020/03/29/04-MySQL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>04-MySQL | 凝水为城</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>
  
<link rel="alternate" href="/atom.xml" title="凝水为城" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
	
	<a href="https://your-url" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
	
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">凝水为城</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">谢红斌的博客小栈</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="search-pop-overlay">
  <div class="popup search-popup">
      <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

  </div>
</div>

  </div>
</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/29/04-MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="谢红斌">
      <meta itemprop="description" content="谢红斌个人网站-记录web前端学习的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="凝水为城">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          04-MySQL
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-03-29 22:42:20 / 修改时间：23:03:30" itemprop="dateCreated datePublished" datetime="2020-03-29T22:42:20+08:00">2020-03-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="主要目的"><a href="#主要目的" class="headerlink" title="主要目的"></a>主要目的</h2><p>学习数据库怎么安装、怎么使用、怎么通过代码的方式去操作它。</p>
<h2 id="什么是数据库"><a href="#什么是数据库" class="headerlink" title="什么是数据库"></a>什么是数据库</h2><p>数据库是一种数据存储的手段，只不过为了便于我们对数据的操作做了很多功能。</p>
<p>数据库就是数据的仓库，用来按照特定的结构去组织和管理我们的数据，有了数据库我们就可以更加方便、便捷的 操作（C / R / U / D）我们需要保存的数据。</p>
<p><strong>数据库查询</strong>：指的是操作数据库的过程（增、删、改、查）</p>
<p><strong>数据库查询语言</strong>：SQL（结构化查询语言）。基本查询语句、常用查询函数如果忘了去看pdf</p>
<p>分页查询数据的子语句：limit <skip>,<length></p>
<p>​                                        （有个公式skip=（page-1）*size）</p>
<p>select * from users limit 2；//限制取几条</p>
<p>select * from users limit <skip>,<length>；//越过多少条取几条</p>
<h2 id="安装与配置-MySQL"><a href="#安装与配置-MySQL" class="headerlink" title="安装与配置 MySQL"></a>安装与配置 MySQL</h2><ul>
<li>在开发领域，存储数据一般用<strong>专门的数据库服务器专门提供的数据库服务</strong>。</li>
<li>如果需要<strong>让自己的机器也可以 提供数据库服务</strong>，那么就需要安装特定的数据库服务器软件，这种类型的软件也有很多：Oracle、MySQL、SQL Server</li>
</ul>
<p>解压版安装过程：</p>
<ol>
<li><p>解压到纯英文路径 </p>
</li>
<li><p>解压目录添加 my.ini （可选，先不添加）</p>
<p>参考：<br><a href="http://www.cnblogs.com/Ray-xujianguo/p/3322455.html" target="_blank" rel="noopener">http://www.cnblogs.com/Ray-xujianguo/p/3322455.html</a></p>
<p><a href="https://gist.github.com/hanjong/1205199" target="_blank" rel="noopener">https://gist.github.com/hanjong/1205199</a></p>
<p><a href="https://dev.mysql.com/doc/refman/5.5/en/mysqld-option-tables.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.5/en/mysqld-option-tables.html</a></p>
</li>
</ol>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysqld] </span><br><span class="line"># MySQL 安装目录 </span><br><span class="line">basedir=C:/Develop/mysql </span><br><span class="line"># 数据文件所在目录 datadir=C:/Develop/mysql/data</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>以管理员身份运行 CMD 执行以下命令，<strong>安装MySQL 服务</strong></li>
</ol>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 定位到安装目录下的 bin 文件夹 （因为安装服务的工具在里面）</span><br><span class="line">$ <span class="built_in">cd</span> &lt;MySQL安装目录&gt;/bin </span><br><span class="line"># 初始化 数据所需文件以及获取一个临时的访问密码，把它复制保存下来，不然要重新安装。要手打，复印会错</span><br><span class="line">#若重新执行命令，会报错，因为mysal/data里的文件已经存在。不让初始化原因：考虑到可能有些重要的商业数据</span><br><span class="line">$ mysqld ‐‐initialize ‐‐user=mysql ‐‐console </span><br><span class="line"># 将 MySQL 安装为服务 可以指定服务名称（可不写，会有个默认服务名） 。安装成功后，可到服务面板查看是否有MySQL服务，建议将启动方式设成手动启动。</span><br><span class="line">$ mysqld ‐‐install MySQL</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>登入 MySQL 服务器，重置密码</li>
</ol>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 先通过用户名密码进入 MySQL 操作环境 </span><br><span class="line">$ mysql ‐u root ‐p </span><br><span class="line">Enter password: # 输入临时密码   </span><br><span class="line"># 设置数据库访问密码，一定要加分号 mysql&gt; <span class="built_in">set</span> password <span class="keyword">for</span> root@localhost = password('<span class="number">123</span>');</span><br><span class="line"># 输入<span class="keyword">exit</span>;可退出，再登陆一遍测试数据库可登陆，再输入show databases;确保数据库成功。</span><br></pre></td></tr></table></figure>

<p>启动服务，可以通过服务面板启动 或命令行（net不管当前目录在哪都可执行，可启动、停止系统上任何一个服务）中输入<strong>net start MySQL</strong>。每次启动完要记得登陆MySQL：$ mysql ‐u root ‐p。</p>
<p>mysql&gt;show databases; 可以查看内置的数据库。</p>
<p>解压版卸载过程：服务卸载、文件删除即可。</p>
<p>​    先到服务面板停止服务，再到命令行（sc不管当前目录在哪都可执行，可删除系统上任何一个服务）卸载服务：<strong>sc delete MySQL</strong>。（服务名称，不是服务面板的显示名称，而要双击显示名称才能看到服务名称）。把解压文件删除掉就好。</p>
<h1 id="数据库管理工具："><a href="#数据库管理工具：" class="headerlink" title="数据库管理工具："></a>数据库管理工具：</h1><p>以后可视化工具会很少使用，所以要熟悉命令行去操作</p>
<h2 id="MySQL-的-REPL-环境对数据库的基本操作"><a href="#MySQL-的-REPL-环境对数据库的基本操作" class="headerlink" title="MySQL 的 REPL 环境对数据库的基本操作"></a>MySQL 的 REPL 环境对数据库的基本操作</h2><p>R E P L：输入、执行、打印、循环</p>
<p>一般如果只是简单操作数据库，推荐使用 MySQL 内置的命令行工具完成：<br>通过命令行运行解压目录下 bin 目录中的 mysql.exe ：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 定位到 bin 目录</span><br><span class="line">$ <span class="built_in">cd</span> &lt;解压目录&gt;/bin </span><br><span class="line"># 运行 mysql，‐u 指定数据库用户名，‐p 指定密码 </span><br><span class="line">$ mysql ‐u root ‐p wanglei </span><br><span class="line"># 一般不建议在命令中填写密码，因为这样会暴露你的密码，一般只加一个 ‐p 但是不给值 </span><br><span class="line">$ mysql ‐u root ‐p </span><br><span class="line">Enter password: # 这时会要求你输入密码</span><br></pre></td></tr></table></figure>

<p>进入 MySQL 客户端的 REPL 环境过后，可以通过标准的 SQL 语句操作数据库。</p>
<p>常见的操作指令</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;  ‐‐ 显示全部数据库 </span><br><span class="line">mysql&gt; create database &lt;db‐name&gt;;  ‐‐ 创建一个指定名称的数据库 mysql&gt; use &lt;db‐name&gt;;  ‐‐ 使用一个数据库，相当于进入指定的数据库 mysql&gt; show tables;  ‐‐ 显示当前数据库中有哪些表 mysql&gt; create table &lt;table‐name&gt; (id int, name varchar(<span class="number">20</span>), age int);  ‐‐ 创建一个指定名称的数据 表，并添加 <span class="number">3</span> 个列 </span><br><span class="line">mysql&gt; desc &lt;table‐name&gt;;  ‐‐ 查看指定表结构 mysql&gt; source ./<span class="built_in">path</span>/to/sql‐file.sql  ‐‐ 执行本地 SQL 文件中的 SQL 语句 </span><br><span class="line">mysql&gt; drop table &lt;table‐name&gt;;  ‐‐ 删除（放弃）一个指定名称的数据表 mysql&gt; drop database &lt;db‐name&gt;;  ‐‐ 删除（放弃）一个指定名称的数据库 mysql&gt; <span class="keyword">exit</span>|quit;  ‐‐ 退出数据库终端</span><br></pre></td></tr></table></figure>

<p>drop少用，不可逆的操作。除了有些数据库管理软件提供的策略：每天晚上12点定期把数据库备份到另一个软件上面，如果你有需求了可以回滚到之前备份的状态</p>
<h2 id="可视化工具"><a href="#可视化工具" class="headerlink" title="可视化工具"></a>可视化工具</h2><p>如果需要复杂的操作，推荐 Navicat Premium(付费)、SQLyog</p>
<p>注意默认字符集及排序规则：utf8、gbk支持中文、排序规则按常规的（general）。默认为拉丁文的。怎样统一设置？</p>
<p>​    在新建/编辑数据库、常规中设置字符集、排序规则。建议为没有汉字的表设不同的字符集</p>
<p>​    或改下MySQL服务的默认字符集：在mysql目录下新建配置文件my.ini（要么只用sublime或记事本编辑，切记不能切换着用，编码类型会变），也可到mysql官方文档看配置：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span> </span><br><span class="line"><span class="comment"># 设置默认字符集,只会影响新建数据库的默认字符集</span></span><br><span class="line"><span class="attr">character-set-server</span>=uft8</span><br></pre></td></tr></table></figure>

<h3 id="导入数据库"><a href="#导入数据库" class="headerlink" title="导入数据库"></a>导入数据库</h3><p>将导出的.sql中的代码复制黏贴到 数据库新建查询 上 执行，然后刷新出现即可。</p>
<h1 id="数据库查询语言：SQL"><a href="#数据库查询语言：SQL" class="headerlink" title="数据库查询语言：SQL"></a>数据库查询语言：SQL</h1><ol>
<li><p>SQL（结构化查询语言）。</p>
</li>
<li><p>基本查询语句、常用查询函数如果忘了去看pdf</p>
</li>
<li><p>分页查询数据的子语句：limit <skip>,<length></p>
</li>
</ol>
<p>​                                        （有个公式skip=（page-1）*size）</p>
<p>select * from users limit 2；//限制取几条</p>
<p>select * from users limit <skip>,<length>；//越过多少条取几条</p>
<h1 id="通过代码执行SQL语句来操作数据库"><a href="#通过代码执行SQL语句来操作数据库" class="headerlink" title="通过代码执行SQL语句来操作数据库"></a>通过代码执行SQL语句来操作数据库</h1><p>1.大体流程：</p>
<p>2.如何在 PHP 代码中操作数据库是我们能否在自己的程序中使用数据库的核心。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库扩展：http:<span class="regexp">//</span>php.net<span class="regexp">/manual/</span>zh<span class="regexp">/refs.database.php</span></span><br></pre></td></tr></table></figure>

<p>如果需要使用 MySQLi 扩展，需要在 php.ini 文件中打开这个扩展（解除注释）</p>
<p>配置完扩展之后，可以用phpinfo();看下配置扩展有没成功（ctrl+F查找下有没存在mysqil的二级标题，有即成功）</p>
<p>3.代码：前提——开启MySQLi 扩展，才能使用该扩展提供的函数</p>
<p>版本1：只是看一下逻辑，不是最终版本</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 能通过PHP代码执行一个SQL语句得到查询的结果</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 建立与数据库服务器之间的连接。连别人数据库也是知道对方的ip、用户名、密码、数据库名，让对方开启数据库访问权限即可</span><br><span class="line"><span class="regexp">//</span>为啥用该API？之前的mysql_connect已被淘汰，这里的i表示提高版</span><br><span class="line"><span class="regexp">//</span>建立连接就涉及到一个问题——指定哪个。参数：IP、用户名、密码、数据库名</span><br><span class="line"><span class="regexp">//</span>写完这句代码就可以到浏览器看下有没报错，没报错就没问题。</span><br><span class="line"><span class="regexp">//</span>用变量来接收，表示一个“桥”，装着web服务器与数据库服务器的连接</span><br><span class="line"><span class="variable">$connection</span> = mysqli_connect(<span class="string">'127.0.0.1'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'demo2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>判断一下这个桥能否正常打通,不报错即可。</span><br><span class="line"><span class="regexp">//</span>var_dump(<span class="variable">$connection</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$connection</span>) &#123;</span><br><span class="line">  <span class="regexp">//</span> 连接数据库失败提示</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;连接数据库失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>建立完连接后，进行查询（增删改查）——mysqli_query（基于哪个连接去查询，查询语句（但建议先在数据库查询窗口试好，再回到代码这执行））</span><br><span class="line"><span class="variable">$query</span> = mysqli_query(<span class="variable">$connection</span>, <span class="string">'select * from users;'</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 基于刚刚创建的连接对象执行一次查询操作，这儿进行查询数据的呈现。但第一次测试，发现呈现的不是想要的数据。</span><br><span class="line"><span class="regexp">//</span>因为得到的<span class="variable">$query</span>是一个查询对象，这个查询对象可以用来再到数据一行一行拿数据</span><br><span class="line"><span class="regexp">//</span>var_dump(<span class="variable">$query</span>);</span><br><span class="line"><span class="regexp">//</span>再以关联数组的方式 取一行 数据mysqli_fetch_assoc(<span class="variable">$query</span>)</span><br><span class="line"><span class="regexp">//</span><span class="variable">$row</span> = mysqli_fetch_assoc(<span class="variable">$query</span>);</span><br><span class="line"><span class="regexp">//</span>var_dump(<span class="variable">$row</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>最终结果：循环去呈现查询结果的每行数据</span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$row</span> = mysqli_fetch_assoc(<span class="variable">$query</span>)) &#123;</span><br><span class="line">  var_dump(<span class="variable">$row</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>版本2：由于1不够严谨</p>
<p>查部分：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 查询数据的查询语句</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 建立与数据库服务器之间的连接</span><br><span class="line"><span class="variable">$connection</span> = mysqli_connect(<span class="string">'127.0.0.1'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'demo2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 必须在查询数据之前</span><br><span class="line"><span class="regexp">//</span> <span class="number">2</span>. 必须传入连接对象和编码</span><br><span class="line"><span class="regexp">//my</span>sqli_set_charset(<span class="variable">$connection</span>, <span class="string">'utf8'</span>);</span><br><span class="line"><span class="regexp">//</span> mysqli_query(<span class="variable">$connection</span>, <span class="string">'set names utf8;'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$connection</span>) &#123;</span><br><span class="line">  <span class="regexp">//</span> 连接数据库失败</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;连接数据库失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 基于刚刚创建的连接对象执行一次查询操作</span><br><span class="line"><span class="variable">$query</span> = mysqli_query(<span class="variable">$connection</span>, <span class="string">'select * from users;'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$query</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;查询失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 遍历结果集</span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$row</span> = mysqli_fetch_assoc(<span class="variable">$query</span>)) &#123;</span><br><span class="line">  var_dump(<span class="variable">$row</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 释放查询结果集</span><br><span class="line">mysqli_free_result(<span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 炸桥 关闭连接。原因：释放占用</span><br><span class="line">mysqli_close(<span class="variable">$connection</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PHP查询中文数据的编码问题：通过mysqli_set_charset(连接对象，编码类型)，必须要在查询数据之前设置，必须传入连接对象和编码。或mysqli_query($connection, ‘set names utf8;’)。第一种常用</p>
</blockquote>
<p>增删改部分：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 增删改数据的查询语句</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 建立与数据库服务器之间的连接</span><br><span class="line"><span class="variable">$connection</span> = mysqli_connect(<span class="string">'127.0.0.1'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'demo2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$connection</span>) &#123;</span><br><span class="line">  <span class="regexp">//</span> 连接数据库失败</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;连接数据库失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 基于刚刚创建的连接对象执行一次查询操作</span><br><span class="line"><span class="variable">$query</span> = mysqli_query(<span class="variable">$connection</span>, <span class="string">'delete from users where id = 5;'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$query</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;查询失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 如何拿到受影响行——mysqli_affected_rows(<span class="variable">$connection</span>)</span><br><span class="line"><span class="regexp">//</span> 注意：传入的一定是连接对象，而不是查询对象。因为该API返回的是这个连接对象上一次查询受影响的行数</span><br><span class="line"><span class="variable">$rows</span> = mysqli_affected_rows(<span class="variable">$connection</span>);</span><br><span class="line"></span><br><span class="line">var_dump(<span class="variable">$rows</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 炸桥 关闭连接</span><br><span class="line">mysqli_close(<span class="variable">$connection</span>);</span><br></pre></td></tr></table></figure>

<p>作业：将音乐列表的json文件换成个数据库。</p>
<h2 id="基于数据库增删改查实例"><a href="#基于数据库增删改查实例" class="headerlink" title="基于数据库增删改查实例"></a>基于数据库增删改查实例</h2><p>具体看code</p>
<p>这儿静态页面已经有了（列表页、添加/编辑页（2者区别：有没默认值））</p>
<p>1.页面拿过来先分析：数据库设计——看下数据库要存什么信息（设计表、设计表里的字段）？</p>
<p>通过界面能得到这些信息，不够回头再来数据库加。表结构添加完，加（改）数据：（通过语句去加或可视化界面加，语句加更方便。原因：insert语句多执行几次数据就多了，不用像后者一行行加）</p>
<h3 id="（列表）查功能"><a href="#（列表）查功能" class="headerlink" title="（列表）查功能"></a>（列表）查功能</h3><p>概括：先通过数据库连接查询出来我们要的数据，查询出来后在html代码中遍历出来即可。</p>
<p>2.现在有静态页面也有数据源了。看列表功能怎么去做。把静态页面写活（动态渲染把代码黏贴到.php，改下css路径。把html代码中需要动态生成的写死的地方给它动态生成：）</p>
<p>把html代码中需要动态生成的写死的地方给它动态生成：</p>
<p>（1）前提：获取已有数据——1.建立连接2.开始查询3.遍历结果集</p>
<p>以前是读文件的方式把数据拿出来，现在是通过读数据库的方式拿数据。现在看起来复杂：代码中要查询、数据库也要查询，之后我们会学怎么封装这些步骤成一个公共函数，调用起来就非常方便了。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 建立连接</span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'test'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$conn</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;连接数据库失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">2</span>. 开始查询</span><br><span class="line"><span class="variable">$query</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">'select * from users;'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$query</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;查询数据失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">3</span>. 遍历结果集。装满了我们之前所查到的数据，再到html代码中遍历一下，但这是闲得蛋疼：循环一下把它装在数组里面（这儿没必要），再到html代码中循环一下这个数组</span><br><span class="line"><span class="regexp">//</span> <span class="keyword">while</span> (<span class="variable">$item</span> = mysqli_fetch_assoc(<span class="variable">$query</span>)) &#123;</span><br><span class="line">	 <span class="regexp">//</span>先测试</span><br><span class="line">	 <span class="regexp">//</span>var_dump(<span class="variable">$item</span>);</span><br><span class="line">	 <span class="regexp">//</span>想办法把数据装起来</span><br><span class="line"><span class="regexp">//</span>   <span class="variable">$data</span>[] = <span class="variable">$item</span>;</span><br><span class="line"><span class="regexp">//</span> &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>有了数据之后，就把要改的写死的代码删掉，然后写php遍历代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">while</span> ($item = mysqli_fetch_assoc($query)): <span class="meta">?&gt;</span></span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span> <span class="attr">scope</span>=<span class="string">"row"</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $item[<span class="string">'id'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&lt;?php echo $item['avatar']; ?&gt;"</span> <span class="attr">class</span>=<span class="string">"rounded"</span> <span class="attr">alt</span>=<span class="string">"&lt;?php echo $item['name']; ?&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $item[<span class="string">'name'</span>]; <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $item[<span class="string">'gender'</span>] == <span class="number">0</span> ? <span class="string">'♀'</span> : <span class="string">'♂'</span>; <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          //注意这儿拿当前时间做个减法</span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $item[<span class="string">'birthday'</span>]; <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-info btn-sm"</span> <span class="attr">href</span>=<span class="string">"edit.php"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endwhile</span> <span class="meta">?&gt;</span></span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="删功能-及批量删除思路"><a href="#删功能-及批量删除思路" class="headerlink" title="删功能 及批量删除思路"></a>删功能 及批量删除思路</h3><p>概括：当我们点击删除按钮时，把对应的当前数据删掉（不可能只是在客户端界面上把当前数据删掉，而是发一个请求到服务端，告诉服务端我们要删掉id为几的这条数据）</p>
<p>具体做法:给删除 一个a链接，让a链接点击时发送一次请求，跟服务端产生一次交互。</p>
<p>注意：要获取一下通过？参数传过来的要删数据的id（因为？的方式可以告诉服务端我们这想删什么）</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a <span class="attribute">class</span>=<span class="string">"btn btn-danger btn-sm"</span> <span class="attribute">href</span>=<span class="string">"delete.php?id=&lt;?php echo <span class="variable">$item</span>['id'] ?&gt;"</span>&gt;删除&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>delete.php中代码：</p>
<p>套路跟之前一样，只是语句不太一样：从查语句变成删语句。但html中要先获取一下通过？参数传过来的要删数据的id（因为？的方式可以告诉服务端我们这想删什么），再delete.php中通过代码接收参数</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 接收要删除的数据 ID</span><br><span class="line"><span class="keyword">if</span> (empty(<span class="variable">$_GET</span>[<span class="string">'id'</span>])) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;必须传入指定参数&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="regexp">//</span>继续往下走，意味着传了id，我们把id接收下来</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">'id'</span>]; <span class="regexp">//</span> =&gt; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 建立连接</span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'test'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$conn</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;连接数据库失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">2</span>. 开始查询</span><br><span class="line"><span class="regexp">//</span>如SQL语句<span class="keyword">delete</span> from users where id <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)一样，把id = <span class="string">' . $id . '</span>;<span class="string">')改成id in ('</span> . <span class="variable">$id</span> . <span class="string">');'</span>)，再在网址上输入<span class="keyword">delete</span>.php?id=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>就批量删除了。原因：上面的<span class="variable">$id</span>接收到的就不再是单个数字，而是<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>这样格式的数据，就完成了批量删除的功能</span><br><span class="line"><span class="variable">$query</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">'delete from users where id in ('</span> . <span class="variable">$id</span> . <span class="string">');'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$query</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;查询数据失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="regexp">//</span>获取受影响行数，以后可不写，这只是为了锻炼调用API能力</span><br><span class="line"><span class="variable">$affected_rows</span> = mysqli_affected_rows(<span class="variable">$conn</span>);</span><br><span class="line"><span class="regexp">//</span>这儿用&lt;=判断，而非&gt;判断。因为我们之后要做个批量删除功能：批量删除那这就也不&gt;<span class="number">0</span>了</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$affected_rows</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;删除失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="regexp">//</span>跳转回去</span><br><span class="line">header(<span class="string">'Location: index.php'</span>);</span><br></pre></td></tr></table></figure>

<p>批量删除思路：checkbox选择/不选择时，删除按钮（有a链接，怎么看出来：底下地址栏有个链接地址显示、地址？后有参数）的显示/隐藏。涉及到一些js功能，PHP与js混在一起情况（js：处理界面上的东西php：处理服务端的逻辑）、js全选不全选功能。自己去做</p>
<h3 id="增（-添加）功能"><a href="#增（-添加）功能" class="headerlink" title="增（/添加）功能"></a>增（/添加）功能</h3><p>静态页面-&gt;动态页面.php（改添加链接、表单添加form属性、给每个input加name、label、给laber加for、option加value）。如</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">option</span> <span class="keyword">value</span>="-1"&gt;请选择性别&lt;/<span class="keyword">option</span>&gt;</span><br><span class="line">      &lt;<span class="keyword">option</span> <span class="keyword">value</span>="1"&gt;男&lt;/<span class="keyword">option</span>&gt;</span><br><span class="line">      &lt;<span class="keyword">option</span> <span class="keyword">value</span>="0"&gt;女&lt;/<span class="keyword">option</span>&gt;</span><br></pre></td></tr></table></figure>

<p>给表单测试下能否正常提交再去处理功能：看Network、点add.php看下Request Payload请求体的name及值是不是都有了</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form <span class="attribute">action</span>=<span class="string">"&lt;?php echo <span class="variable">$_SERVER</span>['PHP_SELF']; ?&gt;"</span> <span class="attribute">method</span>=<span class="string">"post"</span> <span class="attribute">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attribute">autocomplete</span>=<span class="string">"off"</span>&gt;bootstrap的自动完成也关掉，实际项目时打开，测试时关掉影响操作</span><br></pre></td></tr></table></figure>

<p>写一段php脚本（在当前页面被post请求时去处理些对应的逻辑：处理方式、自定义函数优化else嵌套过深、校验（验证非空（一些文本域：文本框及文件域、而一些特殊的，如性别、生日，它们提交的也是可以直接去判断的）、取（文本域）值、接收文件并验证、持久化（保存）、响应</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">add_user</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">  <span class="comment">// 验证非空</span></span></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">'name'</span>])) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请输入姓名'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (!(<span class="keyword">isset</span>($_POST[<span class="string">'gender'</span>]) &amp;&amp; $_POST[<span class="string">'gender'</span>] !== <span class="string">'-1'</span>)) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请选择性别'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">'birthday'</span>])) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请输入日期'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="comment">// 取值</span></span></span><br><span class="line"><span class="php">  $name = $_POST[<span class="string">'name'</span>];</span></span><br><span class="line"><span class="php">  $gender = $_POST[<span class="string">'gender'</span>];</span></span><br><span class="line"><span class="php">  $birthday = $_POST[<span class="string">'birthday'</span>];</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="comment">// 接收文件并验证</span></span></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_FILES[<span class="string">'avatar'</span>])) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请上传头像'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">  </span></span><br><span class="line"><span class="php">  <span class="comment">//获取扩展名，注意没有.</span></span></span><br><span class="line"><span class="php">  $ext = pathinfo($_FILES[<span class="string">'avatar'</span>][<span class="string">'name'</span>], PATHINFO_EXTENSION);</span></span><br><span class="line"><span class="php">  <span class="comment">// =&gt; jpg</span></span></span><br><span class="line"><span class="php">  <span class="comment">//屏蔽掉中文路径的问题：让目标路径没有中文——文件名字有中文就不要这文件名字</span></span></span><br><span class="line"><span class="php">  <span class="comment">//两个点表示跳过2层上级文件夹 找到uploads。若想给文件名加个前缀avatar-，就'../uploads/avatar-'。再拼接上扩展名.和$ext</span></span></span><br><span class="line"><span class="php">  $target = <span class="string">'../uploads/avatar-'</span> . uniqid() . <span class="string">'.'</span> . $ext;</span></span><br><span class="line"><span class="php">  <span class="comment">//移动到目标路径</span></span></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (!move_uploaded_file($_FILES[<span class="string">'avatar'</span>][<span class="string">'tmp_name'</span>], $target)) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'上传头像失败'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">  <span class="comment">//取值：头像的地址，这儿注意是用绝对路径/uploads... 用API字符串截取</span></span></span><br><span class="line"><span class="php">  $avatar = substr($target, <span class="number">2</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="comment">//打印检测下有没问题	</span></span></span><br><span class="line"><span class="php">  <span class="comment">// var_dump($name);</span></span></span><br><span class="line"><span class="php">  <span class="comment">// var_dump($gender);</span></span></span><br><span class="line"><span class="php">  <span class="comment">// var_dump($birthday);</span></span></span><br><span class="line"><span class="php">  <span class="comment">// var_dump($avatar);</span></span></span><br><span class="line"><span class="php">  <span class="comment">// 保存</span></span></span><br><span class="line"><span class="php">  <span class="comment">//数据有了之后，接下来就是插入到数据库里面去</span></span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="comment">// 1. 建立连接</span></span></span><br><span class="line"><span class="php">  $conn = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'test'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (!$conn) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'连接数据库失败'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125; </span></span><br><span class="line"><span class="php">  </span></span><br><span class="line"><span class="php">  <span class="comment">// 写完打印测试下</span></span></span><br><span class="line"><span class="php">  <span class="comment">// var_dump("insert into users values (null, '&#123;$name&#125;', &#123;$gender&#125;, '&#123;$birthday&#125;', '&#123;$avatar&#125;');");</span></span></span><br><span class="line"><span class="php">  <span class="comment">// 2. 开始查询。修改成添加语句（在数据库执行成功后复制过来，将里面的假数据换成真数据，注意  里面有单引号外面就该用双引号  及解析变量外加花括号来声明变量避免问题提高可读性）</span></span></span><br><span class="line"><span class="php">  $query = mysqli_query($conn, <span class="string">"insert into users values (null, '&#123;$name&#125;', &#123;$gender&#125;, '&#123;$birthday&#125;', '&#123;$avatar&#125;');"</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (!$query) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'查询过程失败'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php">  $affected_rows = mysqli_affected_rows($conn);</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="keyword">if</span> ($affected_rows !== <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="php">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'添加数据失败'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php">  <span class="comment">// 响应：header跳转</span></span></span><br><span class="line"><span class="php">  header(<span class="string">'Location: index.php'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="keyword">if</span> ($_SERVER[<span class="string">'REQUEST_METHOD'</span>] === <span class="string">'POST'</span>) &#123;</span></span><br><span class="line"><span class="php">  add_user();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">html种添加错误信息：</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"heading"</span>&gt;</span>添加用户<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($error_message)): <span class="meta">?&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-warning"</span>&gt;</span></span><br><span class="line">      <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $error_message; <span class="meta">?&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>客户端（界面）方面：</p>
<ul>
<li>性别文本域最终提交的是什么？option加了value，提交value；若没，提交innertext。 注意这儿value给-1（请选择性别）、0（女）、1（男）</li>
<li>关于生日界面处理：html5的日期选择框（移动端用得多）或一些JQ的日期选择器插件（有些可以配合bootstrap样式）</li>
</ul>
<h3 id="改（-编辑）功能"><a href="#改（-编辑）功能" class="headerlink" title="改（/编辑）功能"></a>改（/编辑）功能</h3><p>点编辑跳转到编辑页（页面：跟添加页面差不多，复制粘贴改一下部分信息）</p>
<p>注意：头像部分问题留着。文件域不能设置默认值（选不到客户端上用户自己的文件）</p>
<p>逻辑：1.接收处理：接收要修改ID、查询（对应ID）数据、加入SQL更改语句、传入参数（在html中：注意null在==情况跟0相等，所以要===‘0’） 2.提交更改了的表单：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> <span class="number">1</span>. 建立连接</span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'123456'</span>, <span class="string">'test'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$conn</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;连接数据库失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> <span class="number">2</span>. 开始查询。只有一条数据但也一定要加limit <span class="number">1</span>.上面的删除语句也要加：使数据找到这条就不会往下找了，提高效率。</span><br><span class="line"><span class="variable">$query</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">"select * from users where id = &#123;$id&#125; limit 1;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$query</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;查询数据失败&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$user</span> = mysqli_fetch_assoc(<span class="variable">$query</span>);</span><br><span class="line"><span class="regexp">//</span>因为找不到，就不用呈现下面的html了。所以跳转</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$user</span>) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">'&lt;h1&gt;找不到你要编辑的数据&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 2.提交更改了的表单：</p>
<p>分析业务：点击编辑按钮（a链接，点击链接肯定会有请求响应的过程发生）,跳转到另一个地址。</p>
<p>在html传上id：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a <span class="attribute">class</span>=<span class="string">"btn btn-info btn-sm"</span> <span class="attribute">href</span>=<span class="string">"edit.php?id=&lt;?php echo <span class="variable">$item</span>['id'] ?&gt;"</span>&gt;编辑&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>跳转到编辑页面edit.php后，表单提交时也要提交给index.php id，必须在action地址后面加上id</p>
<p><img src="https://raw.githubusercontent.com/hongbinxie/pic-bad/master/img/%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B.png" alt=""></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form <span class="attribute">action</span>=<span class="string">"&lt;?php echo <span class="variable">$_SERVER</span>['PHP_SELF']; ?&gt;?id=&lt;?php echo <span class="variable">$user</span>['id']; ?&gt;"</span></span><br></pre></td></tr></table></figure>

<p>3.提交添加后，请求方式从get拿变成了post发：执行最后一张图的红色三步</p>
<p><img src="https://raw.githubusercontent.com/hongbinxie/pic-bad/master/img/%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">edit</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">global</span> $user;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 验证非空</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">'name'</span>])) &#123;</span><br><span class="line">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请输入姓名'</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!(<span class="keyword">isset</span>($_POST[<span class="string">'gender'</span>]) &amp;&amp; $_POST[<span class="string">'gender'</span>] !== <span class="string">'-1'</span>)) &#123;</span><br><span class="line">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请选择性别'</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">'birthday'</span>])) &#123;</span><br><span class="line">    $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'请输入日期'</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 取值，到这儿复制上面的</span></span><br><span class="line">  $user[<span class="string">'name'</span>] = $_POST[<span class="string">'name'</span>];</span><br><span class="line">  $user[<span class="string">'gender'</span>] = $_POST[<span class="string">'gender'</span>];</span><br><span class="line">  $user[<span class="string">'birthday'</span>] = $_POST[<span class="string">'birthday'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 有上传就修改。这儿接收文件部分需要重新去处理，因为有文件接收文件，没有文件就不修改这头像（新增不用）</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>($_FILES[<span class="string">'avatar'</span>]) &amp;&amp; $_FILES[<span class="string">'avatar'</span>][<span class="string">'error'</span>] === UPLOAD_ERR_OK) &#123;</span><br><span class="line">    <span class="comment">// 用户上传了新头像 -&gt; 用户希望修改头像</span></span><br><span class="line">    $ext = pathinfo($_FILES[<span class="string">'avatar'</span>][<span class="string">'name'</span>], PATHINFO_EXTENSION);</span><br><span class="line">    $target = <span class="string">'../uploads/avatar-'</span> . uniqid() . <span class="string">'.'</span> . $ext;</span><br><span class="line">    <span class="keyword">if</span> (!move_uploaded_file($_FILES[<span class="string">'avatar'</span>][<span class="string">'tmp_name'</span>], $target)) &#123;</span><br><span class="line">      $GLOBALS[<span class="string">'error_message'</span>] = <span class="string">'上传头像失败'</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $user[<span class="string">'avatar'</span>] = substr($target, <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// $user =&gt; 修改过后的信息</span></span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> 将数据更新回数据库</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'REQUEST_METHOD'</span>] === <span class="string">'POST'</span>) &#123;</span><br><span class="line">  edit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件域要呈现原有头像：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img <span class="attribute">src</span>=<span class="string">"&lt;?php echo <span class="variable">$user</span>['avatar']; ?&gt;"</span> <span class="attribute">alt</span>=<span class="string">""</span>&gt;//这条代码。</span><br><span class="line">      &lt;div <span class="attribute">class</span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="attribute">for</span>=<span class="string">"avatar"</span>&gt;头像&lt;/label&gt;</span><br></pre></td></tr></table></figure>

<h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><p>字段类型：char 只适合存固定长度的数据。</p>
<p>​                            varchar 可变长度，如名字，一个汉字3个字符的话长度一般设20；性别，tinyint最小字符；数据库不存年龄这种会变的，而是存生日；头像，一般varchar、200长度来存路径</p>
<p>一般表名起名都是复数形式。</p>
<p>表结构添加完，加、改数据：（通过语句去加或可视化界面加，语句加更方便。原因：insert语句多执行几次数据就多了，不用像后者一行行加）</p>
<p>一般每张表都有id，给id设自动增值</p>
<p>性别用数字存，日期SQL语句存给有特殊格式的字符串如2010-12-12</p>
<p>每次代码中要执行查询语句，都先到数据库里试一下</p>

    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

            <div class="social-item">
              <a target="_blank" class="social-link" href="/atom.xml">
                <span class="icon">
                  <i class="fa fa-rss"></i>
                </span>

                <span class="label">RSS</span>
              </a>
            </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/03/29/03-PHP/" rel="prev" title="03-PHP">
      <i class="fa fa-chevron-left"></i> 03-PHP
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/03/29/05-AjAX/" rel="next" title="05-AjAX">
      05-AjAX <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#主要目的"><span class="nav-number">1.</span> <span class="nav-text">主要目的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是数据库"><span class="nav-number">2.</span> <span class="nav-text">什么是数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装与配置-MySQL"><span class="nav-number">3.</span> <span class="nav-text">安装与配置 MySQL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据库管理工具："><span class="nav-number"></span> <span class="nav-text">数据库管理工具：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-的-REPL-环境对数据库的基本操作"><span class="nav-number">1.</span> <span class="nav-text">MySQL 的 REPL 环境对数据库的基本操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可视化工具"><span class="nav-number">2.</span> <span class="nav-text">可视化工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#导入数据库"><span class="nav-number">2.1.</span> <span class="nav-text">导入数据库</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据库查询语言：SQL"><span class="nav-number"></span> <span class="nav-text">数据库查询语言：SQL</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#通过代码执行SQL语句来操作数据库"><span class="nav-number"></span> <span class="nav-text">通过代码执行SQL语句来操作数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基于数据库增删改查实例"><span class="nav-number">1.</span> <span class="nav-text">基于数据库增删改查实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#（列表）查功能"><span class="nav-number">1.1.</span> <span class="nav-text">（列表）查功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删功能-及批量删除思路"><span class="nav-number">1.2.</span> <span class="nav-text">删功能 及批量删除思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#增（-添加）功能"><span class="nav-number">1.3.</span> <span class="nav-text">增（&#x2F;添加）功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#改（-编辑）功能"><span class="nav-number">1.4.</span> <span class="nav-text">改（&#x2F;编辑）功能</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#注意"><span class="nav-number"></span> <span class="nav-text">注意</span></a></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="谢红斌"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">谢红斌</p>
  <div class="site-description" itemprop="description">谢红斌个人网站-记录web前端学习的个人博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hongbinxie" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hongbinxie" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">谢红斌</span>
</div>
        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        本站访客数<span id="busuanzi_value_site_uv"></span>人次
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        本站总访问量<span id="busuanzi_value_site_pv"></span>次
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  

  
  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/schemes/love.js"></script>

  
	<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
